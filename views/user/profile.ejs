<%- include("partials/user-header.ejs") -%>

        <!-- PAGE TITLE
        ================================================== -->
        <section class="page-title-section bg-img cover-background" data-background="img/bg/bg-8.jpg">
            <div class="container">

                <div class="title-info">
                    <h1>My Profile</h1></div>
                <div class="breadcrumbs-info">
                    <ul class="ps-0">
                        <li><a href="home-shop-1.html">Home</a></li>
                        <li><a href="#">My Profile</a></li>
                    </ul>
                </div>

            </div>
        </section>
        
        <!-- ACCOUNT ORDERS
        ================================================== -->
        <section class="md">
            <div class="container">
                <div class="row justify-content-center">

                    <!-- left panel -->
                    <div class="col-lg-4 col-sm-9 mb-2-3 mb-lg-0">

                        <div class="account-pannel">

                            <div class="p-4">

                                <div class="text-center">
                                    <div class="pb-3">
                                        <img class="img-fluid rounded-circle img-thumbnail"
                                        style="height: 200px;
                                        width: 200px;
                                        object-fit: cover;"  src="/img/<%= user.imageUrl[0]  %>" alt="...">
                                    </div>
                                    <h6 class="mb-0 display-28"><%= user.username %></h6>
                                    <small>Joined <%= moment(user.createdAt).format('Do MMMM, YYYY') %></small>
                                    <!-- <div class="reward-points">
                                        <i class="ti-star text-primary pe-1"></i> Points: 7386
                                    </div> -->
                                </div>
                            </div>

                            <div class="list-group">
                               
                                <a class="list-group-items active" href="/profile"><i class="ti-user pe-2"></i>Profile</a>
                               
                                <a class="list-group-items" href="/orders"><i class="ti-bag pe-2"></i>Orders<span class="badge badge-pill">6</span></a>
                                <a class="list-group-items" href="/address"><i class="ti-location-pin pe-2"></i>Add A New Address</a>
                                <!-- <a class="list-group-items" href="account-wishlist.html"><i class="ti-heart pe-2"></i>Wishlist<span class="badge badge-pill">3</span></a> -->
                                <!-- <a class="list-group-items" href="account-tickets.html"><i class="ti-tag pe-2"></i>My Tickets<span class="badge badge-pill">4</span></a> -->
                            </div>

                        </div>

                    </div>
                    <!-- end left panel -->

                    <!-- right panel -->
                    <div class="col-lg-8">

                        <div class="common-block">

                            <div class="inner-title">
                                <h4 class="mb-0">My Profile</h4>
                                <!-- <p class="mb-0">Time for a Sharp My profile.</p> -->
                            </div>

                            <form  action="/profileedit" method="post" enctype="multipart/form-data">

                                <div class="row">

                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Your Name</label>
                                            <input type="text" class="form-control" value="<%= user.name %>" name="name" placeholder="Your name here" disabled>
                                        </div>

                                    </div>
                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Wallet Amount</label>
                                            <input type="text" class="form-control" value="<%= userData.wallet %>" name="wallet" placeholder="Your name here" disabled>
                                        </div>

                                    </div>
                                    

                                </div>

                                <div class="row">
                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Your User Name</label>
                                            <input type="text" class="form-control" name="username" value="<%= user.username %>" name="username" placeholder="Your user name here">
                                        </div>

                                    </div>

                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Email Address</label>
                                            <input type="email" class="form-control" name="email"  value="<%= user.email %>"  name="email" placeholder="Your email here" >
                                        </div>

                                    </div>

                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Contact Number</label>
                                            <input type="text" class="form-control" name="phone" value="<%= user.phonenumber %>"  name="phone" placeholder="+40-123 456 789" >
                                        </div>

                                    </div>

                                    

                                    <div class="col-sm-6">
                                        
                                        <label>Add your profile photo</label>
                                    
                                    <div class="custom-file">
                                            <input type="file" class="custom-file-input" id="customFile" name="imageUrl" type="file" multiple/>
                                            <label class="custom-file-label" for="customFile">Choose file</label>
                                        </div>
                                    </div>
                                    </div>
                                    <button type="submit" class="butn-style2 mt-4">Update Profile</button>
                                </form>
                                    </div>

                                </div>

                                <!-- <div class="row">

                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Password</label>
                                            <input type="password" class="form-control" name="password" placeholder="Your password here">
                                        </div>

                                    </div>

                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label>Re-Password</label>
                                            <input type="password" class="form-control" name="re-password" placeholder="Your re-password here">
                                        </div>

                                    </div>

                                </div> -->

                                <!-- <div class="row">
                                    <div class="col-sm-12 mb-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="terms-condition">
                                            <label class="form-check-label" for="terms-condition">I agree to the <a href="#" class="text-primary">Terms & Conditions</a></label>
                                        </div>
                                    </div>

                                </div> -->

                               

                           

                        </div>


                        <div class="common-block mt-1">

                            <div class="inner-title">
                                <h4 class="mb-0">Manage Addresses</h4>
                                <!-- <p class="mb-0">Time for a Sharp My profile.</p> -->
                            </div>




                            <div id="accordion1<%= i %> " class="accordion-style3">
                                <% for(var i=0; i < address.length; i++) {%> 
                                <div class="card">
                                    <div class="card-header" id="headingfour">
                                        <h5 class="mb-0">
                                            <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#collapsefour<%= i %>"  aria-expanded="false" aria-controls="collapsefour<%= i %>"><i class="ti-location-pin pe-2 display-29">

                                            </i><%= address[i].addressType %>
                                        </button></h5>
                                    </div>
                                    <div id="collapsefour<%= i %>" class="collapse" aria-labelledby="headingOne" data-bs-parent="#accordion1<%= i %>">
                                        <div class="card-body">


                                            <div class="address">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <!-- <h5><%= address[i].addressType %> </h5> -->
                                                        <address>
                                                            <%= address[i].firstName %><br>
                                                            <%= address[i].addressLine %><br>
                                                            <%= address[i].city %><br>
                                                            <%= address[i].state %><br>
                                                            <%= address[i].country %><br>
                                                            <%= address[i].pinCode %><br>
                                                        </address>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6 mb-1">
                                                        <a  href="/editaddress?addressid=<%= address[i]._id %>" class="butn-style3">Edit address</a>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <button type="button" onclick="deleteAddress('<%= address[i]._id %>')" class="butn-style3">Delete address</button>
                                                    </div>
                                                </div>
                                             </div>
                                             
                                           

                                        </div>
                                    </div>
                                </div>
                                <% } %> 
                            </div>
                                                




                            <!-- <form method="post"> -->

                                
                              

                               

                               

                        </div>

                    </div>
                    <!-- end right panel -->


                   
                </div>
            </div>
        </section>
        <script>

            function  deleteAddress (id){
                   Swal.fire({
                             title: "Are you sure?",
                             text: "You won't be able to revert this!",
                             icon: "warning",
                             showCancelButton: true,
                             confirmButtonColor: "#3085d6",
                             cancelButtonColor: "#d33",
                             confirmButtonText: "Yes, delete it!",
                           }).then(async(result) => {
                             if (result.isConfirmed) {
                              await axios.delete(`/address?addressid=${id}`)
                                 .then((result) => {
                                   if (result.data) {
                                     Swal.fire(
                                       "Deleted!",
                                       "Your file has been deleted.",
                                       "success"
                                     ).then(()=>{
           
                                       location.reload()
                                     })
                                   } else {
                                     alert("something went wrong");
                                   }
                                 });
                             }
                           });
               }
           
           
           
           </script>
        
        <%- include("partials/user-footer.ejs") -%>