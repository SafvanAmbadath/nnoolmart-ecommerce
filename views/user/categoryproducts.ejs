<%- include("partials/user-header.ejs") -%>

        <!-- PAGE TITLE
        ================================================== -->
        <section class="page-title-section bg-img cover-background" data-background="img/bg/bg-8.jpg">
            <div class="container">

                <div class="title-info">
                    <h1>Shop <%= category %> </h1></div>
                <div class="breadcrumbs-info">
                    <ul class="ps-0">
                        <li><a href="/">Home</a></li>
                        <li><a href="">Category</a></li>
                        <li><a href="#"> <%= category %> </a></li>
                    </ul>
                </div>

            </div>
        </section>
        
        <!-- PRODUCT COLUMN THREE
        ================================================== -->
        <section class="md">
            <div class="container">

                <div class="row g-0 align-items-center bg-light rounded p-3 mb-1-9">

                            <div class="col-12 col-md my-1 my-md-0 text-center text-md-start font-weight-600">Showing 1–9 of 27 results</div>

                            <div class="col-12 col-md-auto">

                                <div class="row justify-content-center">

                                    <div class="col-auto my-1 my-md-0">
                                        <label class="m-0">Show:</label>
                                        <select class="w-auto d-inline-block form-select">
                                            <option value="#?limit=24" selected="selected">24</option>
                                            <option value="#?limit=25">25</option>
                                            <option value="#?limit=50">50</option>
                                            <option value="#?limit=75">75</option>
                                            <option value="#?limit=100">100</option>
                                        </select>
                                    </div>

                                    <div class="col-auto my-1 my-md-0">
                                        <label class="m-0">Sort By:</label>
                                        <select class="w-auto d-inline-block form-select">
                                            <option value="#?sort=p.sort_order&amp;order=ASC">Default</option>
                                            <option value="#?sort=pd.name&amp;order=ASC">Name (A - Z)</option>
                                            <option value="#?sort=pd.name&amp;order=DESC">Name (Z - A)</option>
                                            <option value="#?sort=p.price&amp;order=ASC" selected="">Price (Low &gt; High)</option>
                                            <option value="#?sort=p.price&amp;order=DESC">Price (High &gt; Low)</option>
                                            <option value="#?sort=rating&amp;order=DESC">Rating (Highest)</option>
                                            <option value="#?sort=rating&amp;order=ASC">Rating (Lowest)</option>
                                            <option value="#?sort=p.model&amp;order=ASC">Model (A - Z)</option>
                                            <option value="#?sort=p.model&amp;order=DESC">Model (Z - A)</option>
                                        </select>
                                    </div>

                                </div>

                            </div>

                        </div>

                <div class="row justify-content">
<% for(var i=0; i < categoryProducts.length; i++ ){ %>
                    <div class="col-11 col-sm-6 col-lg-4 col-xl-3 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer bg-red">Sale</div><img style="height: 300px;
                                    width: 200px;
                                    object-fit: cover;" src="/img/<%=categoryProducts[i].imageUrl[0] %> " alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3 style="display: inline-block;
                                width: 180px;
                                white-space: nowrap;
                                overflow: hidden !important;
                                text-overflow: ellipsis;"><a href="/product?productid=<%=categoryProducts[i]._id %> "><%=categoryProducts[i].productName %> </a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">₹ <%= categoryProducts[i].price %></span>
                                                        <span class="offer-price">₹ <%= categoryProducts[i].discountPrice %></span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li ><button onclick="addToCart('<%=categoryProducts[i]._id %>')" id="" class="butn-style2" title="Add to Cart">Add to Cart</button></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
<% } %> 
                    <!-- <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-02.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Desktop Speakers</a></h3>
                                <h4 class="price">
                                                        <span class="offer-price">$29.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer left-align bg-primary">New</div><img src="img/products/product-grid/product-03.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Wireless Controller</a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">$57.00</span>
                                                        <span class="offer-price">$55.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-04.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Wireless Headset</a></h3>
                                <h4 class="price">
                                                        <span class="offer-price">$28.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer bg-red">Sale</div><img src="img/products/product-grid/product-06.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Gear 360 Video Editor</a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">$99.00</span>
                                                        <span class="offer-price">$88.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-07.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Standalone VR Headset</a></h3>
                                <h4 class="price">
                                                        <span class="offer-price">$110.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer left-align bg-primary">New</div><img src="img/products/product-grid/product-08.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">USB Flash Drive</a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">$21.00</span>
                                                        <span class="offer-price">$15.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-09.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Mini Bluetooth Speaker</a></h3>
                                <h4 class="price">
                                                        <span class="offer-price">$29.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-10.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Mobile Earphone</a></h3>
                                <h4 class="price">
                                                    <span class="offer-price">$31.00</span>
                                                </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer bg-red">Sale</div><img src="img/products/product-grid/product-11.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Speech Enabled Device</a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">$85.00</span>
                                                        <span class="offer-price">$75.00</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html"><img src="img/products/product-grid/product-12.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Apple iPhone X</a></h3>
                                <h4 class="price">
                                                        <span class="offer-price">$1214.50</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-11 col-sm-6 col-lg-4 mb-1-9">
                        <div class="product-grid">
                            <div class="product-img">
                                <a href="shop-product-detail.html">
                                    <div class="label-offer left-align bg-primary">New</div><img src="img/products/product-grid/product-13.jpg" alt="..."></a>
                            </div>
                            <div class="product-description">
                                <h3><a href="shop-product-detail.html">Plugs And Sockets</a></h3>
                                <h4 class="price">
                                                        <span class="regular-price line-through">$22.00</span>
                                                        <span class="offer-price">$11.40</span>
                                                    </h4>
                            </div>
                            <div class="product-buttons">
                                <ul class="ps-0">
                                    <li><a href="#" class="btn-link" title="Add To Wishlist"><i class="far fa-heart"></i></a></li>
                                    <li><a href="#" class="butn-style2" title="Add to Cart">Add to Cart</a></li>
                                    <li><a href="#" class="btn-link" title="Add To Compare"><i class="fas fa-random"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div> -->

                </div>

                <!-- pagination -->
                <div class="pagination text-small text-uppercase text-extra-dark-gray mt-4">
                            <ul>
                                <li><a href="#"><i class="fas fa-long-arrow-alt-left me-1 d-none d-sm-inline-block"></i> Prev</a></li>
                                <li class="active"><a href="#">1</a></li>
                                <li><a href="#">2</a></li>
                                <li><a href="#">3</a></li>
                                <li><a href="#">Next <i class="fas fa-long-arrow-alt-right ms-1 d-none d-sm-inline-block"></i></a></li>
                            </ul>
                        </div>
                <!-- end pagination -->

            </div>
        </section>
        
        <script>

            // const addToCart = document.querySelector('#btnn')
          
            //     addToCart.onclick =()=>{
                function addToCart(productId){
                    
                    console.log("cart");
                    axios.post(`/cart?productid=${productId}`).then((e)=>{
                        // console.log(e);
                        if(e.data.noAvailablity){
                            // console.log("yes");
                            const Toast = Swal.mixin({
                                toast: true,
                                position: '',
                                showConfirmButton: false,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                    toast.addEventListener('mouseenter', Swal.stopTimer)
                                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                                   }
                              })
            
                                Toast.fire({
                                    icon: 'error',
                                    title: 'Product Sold Out',
                                  })
            
                           }else if(e.data.stockReached){
                                const Toast = Swal.mixin({
                                    toast: true,
              position: '',
              showConfirmButton: false,
              timer: 3000,
              timerProgressBar: true,
              didOpen: (toast) => {
             
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
              }
            })
            
            Toast.fire({
              icon: 'error',
              title: 'Product Out of Stock',
            })
                        } else if(e.data.productAdded){
            
                        console.log("yes");
                        Swal.fire({
              position: '',
              icon: 'success',
              title: 'Your product has been added to the cart',
              showConfirmButton: false,
              timer: 1500
            })
            }else {
               
               location.href='/login'

           }
                    })
                   
              
            }
            </script>
               <!-- axios   -->
               <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
               <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      
               
        
        <%- include("partials/user-footer.ejs") -%>